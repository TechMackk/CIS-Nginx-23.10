################################################################################
# File: roles/validation/templates/validation_report.j2
# Purpose: Validation report template
# Author: DevOps Automation Team
# Last Updated: October 22, 2025
################################################################################

{
  "validation_report": {
    "metadata": {
      "timestamp": "{{ validation_results.timestamp }}",
      "hostname": "{{ validation_results.hostname }}",
      "environment": "{{ validation_results.environment }}",
      "ansible_version": "{{ ansible_version.full }}",
      "os": "{{ ansible_distribution }} {{ ansible_distribution_version }}",
      "kernel": "{{ ansible_kernel }}"
    },
    "summary": {
      "total_checks": {{ validation_results.total_checks }},
      "passed": {{ validation_results.passed }},
      "failed": {{ validation_results.failed }},
      "warnings": {{ validation_results.warnings }},
      "compliance_score": {{ compliance_score }}
    },
    "checks": {{ validation_results.checks | to_json }},
    {% if validation_results.openscap is defined %}
    "openscap": {
      "status": "{{ validation_results.openscap.status }}",
      "exit_code": {{ validation_results.openscap.exit_code }},
      "results_file": "{{ validation_results.openscap.results_file }}",
      "report_file": "{{ validation_results.openscap.report_file }}"
    },
    {% endif %}
    "recommendations": [
      {% if validation_results.failed > 0 %}
      "Review failed checks and remediate issues",
      {% endif %}
      {% if validation_results.warnings > 0 %}
      "Address warning items to improve security posture",
      {% endif %}
      {% if compliance_score | float < 90 %}
      "Compliance score below 90% - immediate attention required",
      {% endif %}
      "Schedule regular compliance scans",
      "Review and update security policies"
    ]
  }
}

################################################################################
# END OF FILE: roles/validation/templates/validation_report.j2
################################################################################